(this["webpackJsonpuse-models-example"]=this["webpackJsonpuse-models-example"]||[]).push([[0],{10:function(e,t,n){"use strict";n.r(t);n(3);var r=n(0),o=n.n(r),a=n(1),l=n.n(a);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var a=1&o?t:n;if(a){try{u(r,1,a(this.v))}catch(l){u(r,2,l)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?u(r,1,t?t(o):o):n?u(r,1,n(o)):u(r,2,o)}catch(l){u(r,2,l)}},r},e}();function u(e,t,n){if(!e.s){if(n instanceof c){if(!n.s)return void(n.o=u.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(u.bind(null,e,t),u.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}function s(e){return e instanceof c&&1&e.s}function f(e,t,n){var r=[];for(var o in e)r.push(o);return function(e,t,n){var r,o,a=-1;return function l(i){try{for(;++a<e.length&&(!n||!n());)if((i=t(a))&&i.then){if(!s(i))return void i.then(l,o||(o=u.bind(null,r=new c,2)));i=i.v}r?u(r,1,i):r=i}catch(f){u(r||(r=new c),2,f)}}(),r}(r,(function(e){return t(r[e])}),n)}"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function m(e,t,n){for(var r;;){var o=e();if(s(o)&&(o=o.v),!o)return a;if(o.then){r=0;break}var a=n();if(a&&a.then){if(!s(a)){r=1;break}a=a.s}if(t){var l=t();if(l&&l.then&&!s(l)){r=2;break}}}var i=new c,f=u.bind(null,i,2);return(0===r?o.then(v):1===r?a.then(m):l.then(d)).then(void 0,f),i;function m(r){a=r;do{if(t&&(l=t())&&l.then&&!s(l))return void l.then(d).then(void 0,f);if(!(o=e())||s(o)&&!o.v)return void u(i,1,a);if(o.then)return void o.then(v).then(void 0,f);s(a=n())&&(a=a.v)}while(!a||!a.then);a.then(m).then(void 0,f)}function v(e){e?(a=n())&&a.then?a.then(m).then(void 0,f):m(a):u(i,1,a)}function d(){(o=e())?o.then?o.then(v).then(void 0,f):v(o):u(i,1,a)}}function v(e,t){try{var n=e()}catch(r){return t(r)}return n&&n.then?n.then(void 0,t):n}var d={not_empty:function(e){return 0===e.length?"can't be empty":void 0},email:function(e){var t=document.createElement("input");t.type="email",t.value=e;var n=t.checkValidity(),r=e.split("@");return r[1]?(r[1].indexOf(".")<=0&&(n=!1),n?void 0:"Invalid Email Address"):"Email Address can't be blank"},az_space:function(e){if(!/^[A-Za-z .]+$/.test(e))return"Only letters and spaces are allowed."},website:function(e){if(!/(^|\s)((https?:\/\/)[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/gi.test(e))return"Please enter a valid url."},person:function(e){if(!/^(-?([A-Z].\s)?([A-Z][a-z]+)\s?)+([A-Z]'([A-Z][a-z]+))?$/g.test(e))return"Enter a valid name."}};function h(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{value:e,validate:n}}var g=function(e,t){return void 0!==e[t]},p=function(e){var t,n=(t=e,Object.assign.apply(Object,[{}].concat(function e(t,n){var r;return void 0===n&&(n=""),(r=[]).concat.apply(r,Object.keys(t).map((function(r){var o;return"object"!==typeof t[r]||Array.isArray(t[r])?((o={})[n?n+"."+r:r]=t[r],o):e(t[r],n?n+"."+r:r)})))}(t))));for(var r in n)Array.isArray(n[r])||(n[r]=[n[r]]);return console.log("validationPaths",n),n};function y(e,t){var n=("function"===typeof e?e:g(d,e)?d[e]:function(){console.warn("built in validator with name `%s` not found. this is a no-op",e)})(t);return n instanceof Promise?n:n?Promise.reject(n instanceof Error?n:new Error(n)):Promise.resolve()}function b(e){return e.split(".")}function E(e,t){for(var n in e)"object"===typeof e[n]?E(e[n],t):e[n]=t;return e}function S(e){console.log("parseOptions()");var t={},n={};!function e(t,n,r){for(var o in t)if(console.log(o,t[o]),"object"===typeof t[o]&&null!==t[o]){var a=!0;g(t[o],"value")&&(n[o]=t[o].value,a=!1),g(t[o],"validate")&&(r[o]=t[o].validate,a=!1),a&&(g(n,o)||(n[o]={}),g(r,o)||(r[o]={}),e(t[o],n[o],r[o]))}else n[o]=t[o]}(e,t,n);var r=E(i({},t),!1),o=p(n);return console.log(t,r,o),{defaultState:t,errorState:r,validationPaths:o}}function k(e){return"string"===typeof e?e:"object"===typeof e&&g(e,"message")?e.message:e.toString()}var w,N=function(e){void 0===e&&(e={}),console.log("useModels()");var t=S(e),n=t.defaultState,o=t.errorState,a=t.validationPaths,l={},c=Object(r.useState)(n),u=c[0],s=c[1],d=Object(r.useState)(o),h=d[0],p=d[1];console.log(u,h);var w=function(e,t){try{var n=!1;return console.log("validatePath()"),Promise.resolve(function(){if(g(a,e)){var r=function(t){if(n)return t;p(j(e,!1,h))},o=0,l=m((function(){return!n&&o<a[e].length}),(function(){return o++}),(function(){return v((function(){return Promise.resolve(y(a[e][o],t)).then((function(){}))}),(function(t){return console.log("gotError in validatePath()",t),n=!0,p(j(e,k(t),h))}))}));return l&&l.then?l.then(r):r(l)}console.log("no validation for field")}())}catch(r){return Promise.reject(r)}},N=function(){};function P(e){console.log("getValue()");for(var t=b(e),n=u,r=0;r<t.length;r++)n=n[t[r]];return n}function j(e,t,n){void 0===n&&(n=u),console.log("getUpdate()");var r=i({},n),o=b(e);if(o.length){for(var a=r,l=0;l<o.length-1;l++)a=g(a,o[l])?a[o[l]]:{};a[o[o.length-1]]=t}return r}var A=Object(r.useCallback)((function(e,t){void 0===t&&(t=!1),console.log("hydrate()"),s(i({},u,{},e)),t&&p(i({},h,{},t))}),[]);return{input:function(e,t){return void 0===t&&(t="text"),console.log("input()"),{onChange:function(t){console.log(t);var n=t;g(t,"value")&&(n=t.value),console.log(g(t,"target")),g(t,"target")&&(n=t.target.value),console.log(n);var r=P(e);s(j(e,n)),l[e]&&l[e](n,r),w(e,n)},value:P(e),name:e,type:t}},checkbox:function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=!1),console.log("checkbox()"),{onChange:function(r){var o=r.target.checked?t:n,a=P(e);s(j(e,o)),l[e]&&l[e](o,a),w(e,o)},checked:P(e)===t,type:"checkbox",name:e,value:t}},radio:function(e,t){return void 0===t&&(t=null),console.log("radio()"),{onChange:function(n){if(n.target.checked){var r=t,o=P(e);s(j(e,t)),l[e]&&l[e](r,o),w(e,r)}},checked:P(e)===t,type:"radio",name:e,value:t}},submit:function(e){return console.log("submit()"),function(t){try{return console.log("onSubmit()"),t.preventDefault(),Promise.resolve(function(){try{var e=function(){console.log("got results",r);var e=E(i({},n),!1);return console.log("errState is",e),r.length&&(console.log("got %d errors",r.length),r.forEach((function(t){console.log("looking at errors",t.field,t.error),e=j(t.field,k(t.error),e)}))),console.log(e),p(e),r};console.log("validate()");var r=[],o=f(a,(function(e){var t=0;return m((function(){return t<a[e].length}),(function(){return t++}),(function(){var n=v((function(){return Promise.resolve(y(a[e][t],P(e))).then((function(){}))}),(function(t){r.push({field:e,error:t})}));if(n&&n.then)return n.then((function(){}))}))}));return Promise.resolve(o&&o.then?o.then(e):e())}catch(t){return Promise.reject(t)}}()).then((function(n){console.log("got result from validate()",n),n.length?N(h,u):e(u),t.stopPropagation()}))}catch(t){return Promise.reject(t)}}},error:function(e){return console.log("error()"),N=e,function(t){console.log("errorHandler()"),e(h,u)}},errors:h,state:u,watch:function(e,t){return console.log("watch()"),l[e]=t,function(){delete l[e]}},hydrate:A,set:function(e,t,n,r){void 0===n&&(n=!0),void 0===r&&(r=!0);var o=P(e);s(j(e,t)),r&&l[e]&&l[e](t,o),n&&w(e,t)},get:function(e){return P(e)},getState:function(){return console.log("getState()"),u},getErrors:function(){return console.log("getErrors()"),h},setState:s,setErrors:p}};function P(){console.log("App.render()");var e=N({name:h("",(function(e){if(e.length<5)return"Name must be at least 5 characters"})),username:h("","checkUsername"),email:h("","email"),remember:!1,newsletter:"no",user_type:"user"}),t=e.state,n=e.errors,a=e.input,l=e.checkbox,i=e.radio,c=e.submit,u=e.error,s=e.watch,f=e.hydrate,m=e.set;Object(r.useEffect)((function(){f({name:"Garrett",email:"test@test.com",newsletter:"yes"})}),[f]);var v=c((function(e){console.log(e)})),d=u((function(e,t){}));return s("username",(function(e,t){console.log("username changed from %s to %s",t,e)})),o.a.createElement("div",{className:"example"},o.a.createElement("form",{onSubmit:v,onError:d},o.a.createElement("h3",null,"use-models example"),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Select user type:"),o.a.createElement("div",{className:"user-type-select"},o.a.createElement("div",{className:"user-type-option"+("user"===t.user_type?" selected":""),onClick:function(e){return m("user_type","user")}},"Normal User"),o.a.createElement("div",{className:"user-type-option"+("admin"===t.user_type?" selected":""),onClick:function(e){return m("user_type","admin")}},"Admin User"))),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Name"),o.a.createElement("input",a("name")),n.name&&o.a.createElement("p",{className:"help-text"},n.name)),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Desired Username"),o.a.createElement("input",a("username")),n.username&&o.a.createElement("p",{className:"help-text"},n.username)),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Email Address:"),o.a.createElement("input",a("email","email")),n.email&&o.a.createElement("p",{className:"help-text"},n.email)),o.a.createElement("div",{className:"form-group-check"},o.a.createElement("input",l("remember"))," ",o.a.createElement("label",null,"Remember me")),o.a.createElement("div",{className:"form-group with-nested"},o.a.createElement("label",null,"Sign up for newsletter?"),o.a.createElement("div",{className:"form-group-check"},o.a.createElement("input",i("newsletter","yes"))," ",o.a.createElement("label",null,"Yes, Sign me up!")),o.a.createElement("div",{className:"form-group-check"},o.a.createElement("input",i("newsletter","no"))," ",o.a.createElement("label",null,"No thanks"))),o.a.createElement("button",{type:"submit"},"Submit"),o.a.createElement("div",{className:"results"},o.a.createElement("div",{className:"result-50"},o.a.createElement("strong",null,"State:"),o.a.createElement("pre",null,JSON.stringify(t,null,2))),o.a.createElement("div",{className:"result-50"},o.a.createElement("strong",null,"Errors:"),o.a.createElement("pre",null,JSON.stringify(n,null,2))))))}w=function(e){return console.log("checkUsername()"),new Promise((function(e,t){setTimeout((function(){t(new Error("That username is taken"))}),200)}))},d["checkUsername"]=w,l.a.render(o.a.createElement(P,null),document.getElementById("root"))},2:function(e,t,n){e.exports=n(10)},3:function(e,t,n){}},[[2,1,2]]]);
//# sourceMappingURL=main.841eacc1.chunk.js.map